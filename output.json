{
  "checkout": {
    "description": "Checkout repository",
    "commands": [
      "git checkout SCM"
    ]
  },
  "setup": {
    "description": "Setup Python environment and install dependencies",
    "commands": [
      "python -m venv venv",
      "source venv/bin/activate",
      "pip install --user --upgrade pip",
      "pip install --user -r requirements.txt"
    ],
    "tools": [
      "python3"
    ],
    "environment": {
      "HOME": "${PWD}"
    }
  },
  "build": {
    "description": "Compile Python sources and build Docker image",
    "commands": [
      "compileall .",
      "docker build -t ${IMAGE_NAME}:${BUILD_NUMBER} ."
    ],
    "tools": [
      "docker"
    ],
    "environment": {
      "HOME": "${PWD}",
      "PATH": "${HOME}/.local/bin:${PATH}"
    }
  },
  "test": {
    "description": "Run unit, integration tests",
    "commands": [
      "nosetests -v test",
      "nosetests -v int_test"
    ],
    "tools": [
      "pytest"
    ],
    "environment": {
      "HOME": "${PWD}",
      "PATH": "${HOME}/.local/bin:${PATH}"
    }
  },
  "quality": {
    "description": "Code quality checks and security scans",
    "commands": [
      "safety check",
      "pylint src/",
      "flake8 src/",
      "bandit -r src/"
    ],
    "tools": [
      "pylint",
      "flake8",
      "bandit"
    ],
    "environment": {
      "HOME": "${PWD}",
      "PATH": "${HOME}/.local/bin:${PATH}"
    }
  }
}